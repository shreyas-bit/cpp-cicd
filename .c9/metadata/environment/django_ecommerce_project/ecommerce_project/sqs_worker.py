{"filter":false,"title":"sqs_worker.py","tooltip":"/django_ecommerce_project/ecommerce_project/sqs_worker.py","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":31,"column":0},"action":"insert","lines":["# sqs_worker.py","import boto3","import time","from django.conf import settings","","sqs = boto3.client('sqs', region_name=settings.AWS_REGION)","","def process_sqs_messages():","    while True:","        # Receive messages from the queue","        response = sqs.receive_message(","            QueueUrl=settings.AWS_SQS_QUEUE_URL,","            AttributeNames=['All'],","            MaxNumberOfMessages=10,  # Adjust the number of messages you want to fetch at a time","            WaitTimeSeconds=20  # Long polling to reduce costs","        )","","        if 'Messages' in response:","            for message in response['Messages']:","                # Process the message (e.g., send a notification, perform a background task)","                print(f\"Processing message: {message['Body']}\")","                ","                # Delete the message from the queue after processing","                sqs.delete_message(","                    QueueUrl=settings.AWS_SQS_QUEUE_URL,","                    ReceiptHandle=message['ReceiptHandle']","                )","                print(f\"Message {message['MessageId']} deleted from queue.\")","        else:","            print(\"No messages in the queue, waiting for 20 seconds...\")","            time.sleep(20)",""],"id":1}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":31,"column":0},"end":{"row":31,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1731684897308,"hash":"2d52881d8b55c5317005e568bd08f1cba7a36f9f"}